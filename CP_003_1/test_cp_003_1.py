from selenium.webdriver.common.by import By
from selenium.webdriver.support.select import Select
from src.testproject.classes import DriverStepSettings, StepSettings
from src.testproject.decorator import report_assertion_errors
from src.testproject.enums import SleepTimingType
from src.testproject.sdk.drivers import webdriver
import pytest


"""
This pytest test was automatically generated by TestProject
    Project: My first Project
    Package: TestProject.Generated.Tests.MyFirstProject
    Test: CP-003-1
    Generated by: Ruben Rodriguez (rdrm.05@gmail.com)
    Generated on 07/14/2021, 22:14:55
"""


@pytest.fixture()
def driver():
    driver = webdriver.Chrome(token="jAoYsZdMEgRqqPtB0JkVcHYdA_A0iOGbXoFE-wqhxVk",
                              project_name="My first Project",
                              job_name="CP-003-1")
    step_settings = StepSettings(timeout=15000,
                                 sleep_time=500,
                                 sleep_timing_type=SleepTimingType.Before)
    with DriverStepSettings(driver, step_settings):
        yield driver
    driver.quit()


@report_assertion_errors
def test_main(driver):
    """Se creará un nuevo usuario “Shop manager” para las pruebas de la plataforma."""
    # Test Parameters
    # Auto generated application URL parameter
    ApplicationURL = "https://www.google.com/"
    Username = ""
    Email = ""

    # 1. Navigate to '{ApplicationURL}'
    # Navigates the specified URL (Auto-generated)
    driver.get(f'{ApplicationURL}')

    # 2. Navigate to 'https://ecommercetest.local/wp-login.php'
    driver.get("https://ecommercetest.local/wp-login.php")

    # 3. Click 'log'
    log = driver.find_element(By.CSS_SELECTOR,
                              "#user_login")
    log.click()

    # 4. Type 'TesterAdmin' in 'log'
    log = driver.find_element(By.CSS_SELECTOR,
                              "#user_login")
    log.send_keys("TesterAdmin")

    # 5. Click 'pwd'
    pwd = driver.find_element(By.CSS_SELECTOR,
                              "#user_pass")
    pwd.click()

    # 6. Type 'Super4dmin2021*#' in 'pwd'
    pwd = driver.find_element(By.CSS_SELECTOR,
                              "#user_pass")
    pwd.send_keys("Super4dmin2021*#")

    # 7. Click 'wp-submit'
    wp_submit = driver.find_element(By.CSS_SELECTOR,
                                    "#wp-submit")
    wp_submit.click()

    # 8. Scroll window by ('0','200')
    driver.execute_script("window.scrollBy(0,200)")

    # 9. Scroll window by ('0','100')
    driver.execute_script("window.scrollBy(0,100)")

    # 10. Click 'Add New'
    add_new = driver.find_element(By.XPATH,
                                  "//li[16]//a[. = 'Add New']")
    add_new.click()

    # 11. Click 'user_login'
    user_login = driver.find_element(By.CSS_SELECTOR,
                                     "#user_login")
    user_login.click()

    # 12. Type '{Username}' in 'user_login'
    user_login = driver.find_element(By.CSS_SELECTOR,
                                     "#user_login")
    user_login.send_keys(f'{Username}')

    # 13. Click 'email'
    email = driver.find_element(By.CSS_SELECTOR,
                                "#email")
    email.click()

    # 14. Type '{Email}' in 'email'
    email = driver.find_element(By.CSS_SELECTOR,
                                "#email")
    email.send_keys(f'{Email}')

    # 15. Click 'first_name'
    first_name = driver.find_element(By.CSS_SELECTOR,
                                     "#first_name")
    first_name.click()

    # 16. Type 'Shop_Manager' in 'first_name'
    first_name = driver.find_element(By.CSS_SELECTOR,
                                     "#first_name")
    first_name.send_keys("Shop_Manager")

    # 17. Click 'last_name'
    last_name = driver.find_element(By.CSS_SELECTOR,
                                    "#last_name")
    last_name.click()

    # 18. Scroll window by ('0','100')
    driver.execute_script("window.scrollBy(0,100)")

    # 19. Scroll window by ('0','100')
    driver.execute_script("window.scrollBy(0,100)")

    # 20. Type 'Tester' in 'last_name'
    last_name = driver.find_element(By.CSS_SELECTOR,
                                    "#last_name")
    last_name.send_keys("Tester")

    # 21. Click 'role'
    role = driver.find_element(By.CSS_SELECTOR,
                               "#role")
    role.click()

    # 22. Select the 'shop_manager' option in 'role'
    role = driver.find_element(By.CSS_SELECTOR,
                               "#role")
    Select(role).select_by_value("shop_manager")

    # 23. Click 'role'
    role = driver.find_element(By.CSS_SELECTOR,
                               "#role")
    role.click()

    # 24. Click 'createuser'
    createuser = driver.find_element(By.CSS_SELECTOR,
                                     "#createusersub")
    createuser.click()

    # 25. Click 'Log Out'
    log_out = driver.find_element(By.XPATH,
                                  "//li/a[. = 'Log Out']")
    log_out.click()
